(function(e,d){typeof exports=="object"&&typeof module<"u"?module.exports=d(require("vue"),require("lkt-string-tools"),require("lkt-http-client")):typeof define=="function"&&define.amd?define(["vue","lkt-string-tools","lkt-http-client"],d):(e=typeof globalThis<"u"?globalThis:e||self,e.LktFieldFile=d(e.Vue,e.LktStringTools,e.LktHttpClient))})(this,function(e,d,c){"use strict";const u=["data-disabled"],p=["name","id","disabled","readonly","placeholder","accept"],m=["for","innerHTML"],y={name:"LktFieldFile",inheritAttrs:!1},h=e.defineComponent({...y,props:{modelValue:{type:Object,default:()=>({id:"",text:""})},name:{type:String,default:d.generateRandomString(16)},label:{type:String,default:""},resource:{type:String,default:""},resourceData:{type:Object,default:()=>({})},accept:{type:String,default:"*/*"},placeholder:{type:String,default:""},palette:{type:String,default:""},readMode:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},allowReadModeSwitch:{type:Boolean,default:!1},tabindex:{type:Number,default:void 0},mandatory:{type:Boolean,default:!1},reset:{type:Boolean,default:!1},resetMessage:{type:String,default:""},mandatoryMessage:{type:String,default:""},infoMessage:{type:String,default:""},errorMessage:{type:String,default:""},switchEditionMessage:{type:String,default:""}},emits:["update:modelValue","uploading","upload-success","upload-error"],setup(t,{emit:g}){const o=g,l=t,s=d.generateRandomString(16);e.ref(null),e.ref(l.modelValue);const k=e.ref(l.modelValue);e.ref(!l.readMode);const S=a=>{let i=a.target;if(i.files&&i.files[0]){let r=new FileReader;r.onload=M=>{o("uploading");let f=JSON.parse(JSON.stringify(l.resourceData));f.files=i.files[0],c.httpCall(l.resource,f).then(n=>{o("upload-success",n),k.value=n.data}).catch(n=>{o("upload-error",n)})},r.readAsDataURL(i.files[0])}},b=e.computed(()=>{const a=["lkt-field","lkt-field-file"];return l.palette&&a.push(`lkt-field--${l.palette}`),l.disabled&&a.push("is-disabled"),a.push(l.modelValue?"is-filled":"is-empty"),a.join(" ")});return(a,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(b.value),"data-disabled":t.disabled},[e.renderSlot(a.$slots,"prefix"),e.createElementVNode("input",{type:"file",name:t.name,id:e.unref(s),disabled:t.disabled,readonly:t.readonly,placeholder:t.placeholder,ref:"field",accept:t.accept,onChange:S},null,40,p),t.label?e.withDirectives((e.openBlock(),e.createElementBlock("label",{key:0,for:e.unref(s),innerHTML:t.label},null,8,m)),[[e.vShow,!t.disabled&&!t.readonly]]):e.createCommentVNode("",!0)],10,u))}}),F="";return{install:t=>{t.component("lkt-field-file",h)}}});
